!function(e){"use strict";if("undefined"==typeof wc_serial_numbers_vars)return!1;e(document).ready((function(){e(document).on("click",".wcsn-key",(function(){const a=e(this);if(a.hasClass("copying"))return;const s=e("<input>");e("body").append(s),s.val(a.data("unmasked")).select(),document.execCommand("copy"),s.remove(),a.text(wc_serial_numbers_vars.i18n.copied).addClass("copying"),setTimeout((function(){a.text(a.data("masked")).removeClass("copying")}),1e3)})).on("mouseenter mouseleave",".wcsn-key:not(.copying)",(function(a){const s=e(this);"mouseenter"===a.type?s.text(s.data("unmasked")):s.text(s.data("masked"))})).on("submit",".wcsn-api-form",(function(a){a.preventDefault();const s=e(this);e.ajax({url:wc_serial_numbers_vars.apiurl,method:"POST",data:s.serialize(),dataType:"json",beforeSend(){s.addClass("loading"),s.find(".wcsn-api-response").text("Loading...")},success(e){s.find(".wcsn-api-response").text(JSON.stringify(e,null,2))},error:function(e){s.find(".wcsn-api-response").text(JSON.stringify(e,null,2))},always(){s.removeClass("loading")}})})),e(".wcsn_search_product, .wc-serial-numbers-select-product").select2({ajax:{cache:!0,delay:500,url:wc_serial_numbers_vars.ajaxurl,method:"POST",dataType:"json",data:e=>({action:"wc_serial_numbers_search_product",nonce:wc_serial_numbers_vars.search_nonce,search:e.term,page:e.page||1}),processResults:(e,a)=>(!1===e.success&&alert(e.data.message),a.page=a.page||1,{results:e.results,pagination:{more:e.pagination.more}})},placeholder:wc_serial_numbers_vars.i18n.search_product,minimumInputLength:1,allowClear:!0}),e(".wcsn_search_order").select2({ajax:{cache:!0,delay:500,url:wc_serial_numbers_vars.ajaxurl,method:"POST",dataType:"json",data:e=>({action:"wc_serial_numbers_search_orders",nonce:wc_serial_numbers_vars.search_nonce,search:e.term,page:e.page}),processResults:(e,a)=>(!1===e.success&&alert(e.data.message),a.page=a.page||1,{results:e.results,pagination:{more:e.pagination.more}})},placeholder:wc_serial_numbers_vars.i18n.search_order,minimumInputLength:1,allowClear:!0}),e(".wcsn_search_customer").select2({ajax:{cache:!0,delay:500,url:wc_serial_numbers_vars.ajaxurl,method:"POST",dataType:"json",data:e=>({action:"wc_serial_numbers_search_customers",nonce:wc_serial_numbers_vars.search_nonce,search:e.term,page:e.page}),processResults:(e,a)=>(!1===e.success&&alert(e.data.message),a.page=a.page||1,{results:e.results,pagination:{more:e.pagination.more}})},placeholder:wc_serial_numbers_vars.i18n.search_customer,minimumInputLength:1,allowClear:!0}),void 0!==e.fn.datepicker&&e(".wc-serial-numbers-select-date").datepicker({changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",firstDay:7,minDate:new Date}),void 0!==typeof e.fn.select2&&e(":input.wcsn-select2").filter(":not(.enhanced)").each((function(){var a=e(this),s={allowClear:a.data("allow_clear")&&!a.prop("multiple")||!0,placeholder:a.data("placeholder")||a.attr("placeholder")||"",minimumInputLength:a.data("minimum_input_length")?a.data("minimum_input_length"):0,ajax:{url:wc_serial_numbers_vars.ajaxurl,dataType:"json",delay:250,method:"POST",data:function(e){return{term:e.term,action:a.data("action"),type:a.data("type"),_wpnonce:a.data("nonce")||wc_serial_numbers_vars.ajax_nonce,exclude:a.data("exclude"),include:a.data("include"),limit:a.data("limit"),page:e.page||1}},processResults:function(e){return e.page=e.page||1,e},cache:!0}};a.data("action")||delete s.ajax,a.select2(s).addClass("enhanced")})),e('#wcsn-add-key-form :input[name="status"]').on("change",(function(){var a=e(this),s=a.closest("form"),r=s.find(':input[name="customer_id"]'),t=s.find(':input[name="order_id"]');if(!e(this).is(":checked")||!e(this).val())return!1;"create_order"===a.val()?(r.prop("required",!0).closest("tr").show(),t.prop("required",!1).closest("tr").hide()):"existing_order"===a.val()?(r.prop("required",!1).closest("tr").hide(),t.prop("required",!0).closest("tr").show()):(r.prop("required",!1).closest("tr").hide(),t.prop("required",!1).closest("tr").hide())})).trigger("change")}))}(jQuery,window);